import streamlit as st

class ê³¼ì„¸í‘œì¤€:
    def ì†Œë“ê³µì œ(self, ì—°ì†Œë“, ì‹ ìš©, í˜„ê¸ˆ, ì²´í¬):
        ê³µì œ = ì—°ì†Œë“*0.25
        ì‹ ìš©_ê³µì œ = 0
        ì²´í¬_í˜„ê¸ˆ_ê³µì œ = 0
        if ì‹ ìš©+ì²´í¬+í˜„ê¸ˆ >= ê³µì œ:
            if ì‹ ìš© > ê³µì œ:
                ì‹ ìš©_ê³µì œ = (ì‹ ìš©-ê³µì œ)*0.15
                ì²´í¬_í˜„ê¸ˆ_ê³µì œ = (ì²´í¬+í˜„ê¸ˆ)*0.3
            elif ì‹ ìš© == ê³µì œ:
                ì²´í¬_í˜„ê¸ˆ_ê³µì œ = (ì²´í¬+í˜„ê¸ˆ)*0.3
            else:
                ê³µì œ -= ì‹ ìš©
                ì²´í¬_í˜„ê¸ˆ_ê³µì œ = ((ì²´í¬+í˜„ê¸ˆ)-ê³µì œ)*0.3
        
        ì†Œë“_ê³µì œ = ì‹ ìš©_ê³µì œ + ì²´í¬_í˜„ê¸ˆ_ê³µì œ
        if ì†Œë“_ê³µì œ > ì†Œë“ê³µì œ_í•œë„ì•¡:
            ì†Œë“_ê³µì œ = ì†Œë“ê³µì œ_í•œë„ì•¡
        global ì¶”ì²œ
        ì¶”ì²œ = {
                "ì‹ ìš©_ê³µì œ": ì‹ ìš©_ê³µì œ,
                "ì²´í¬_í˜„ê¸ˆ_ê³µì œ": ì²´í¬_í˜„ê¸ˆ_ê³µì œ,
                "ì†Œë“_ê³µì œ": ì†Œë“_ê³µì œ,
            }
        return ì†Œë“_ê³µì œ

    def ì†Œë“ê³µì œ_ì´ˆê³¼(self):
        return 0


# 300ë§Œì›ê¹Œì§€, ì—°ì†Œë“ ìƒí•œ 7000
def ê¸‰ì—¬ë³„_ì´í•œë„ì•¡(ì—°ì†Œë“):
    if ì—°ì†Œë“ <= 7000:
        return 300
    elif ì—°ì†Œë“ > 7000:
        return 250        


def run_options(selected_options):
    selected_options = [eval(i+'()') for i in selected_options]
    return selected_options


def result_message(ì°¨ê°ì§•ìˆ˜ì•¡):
    ì°¨ê°ì§•ìˆ˜ì•¡ = int(ì°¨ê°ì§•ìˆ˜ì•¡)
    if ì°¨ê°ì§•ìˆ˜ì•¡ > 0:
        return f'{ì°¨ê°ì§•ìˆ˜ì•¡}ë§Œì› ì§€ë¶ˆí•˜ì…”ì•¼ í•©ë‹ˆë‹¤.'
    else:
        return f'{ì°¨ê°ì§•ìˆ˜ì•¡}ë§Œì› í™˜ê¸‰ ëŒ€ìƒì…ë‹ˆë‹¤.' 
    
    
def ì†Œë“ê³µì œ_ê²°ê³¼(ì†Œë“_ê³µì œ):
    if ì†Œë“_ê³µì œ < ì†Œë“ê³µì œ_í•œë„ì•¡:
        return f"<p style='color:red'>{int(ì†Œë“ê³µì œ_í•œë„ì•¡-ì†Œë“_ê³µì œ)}ë§Œì› ê³µì œ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>"
    else:
        return f"<p style='color:green'>ì†Œë“ê³µì œë¥¼ ì´ˆê³¼ ë‹¬ì„±.</p>"
       

def main():
    st.set_page_config(layout="wide", page_title="My Streamlit App", page_icon="ğŸˆ", initial_sidebar_state="expanded")

    st.title("ì—°ë§ì •ì‚° (ì†Œë“ê³µì œ)")
    col1, col2 = st.columns(2)
    
    with col1:
         # ìˆ«ì ì…ë ¥ í•„ë“œ
        global ì—°ì†Œë“
        ì—°ì†Œë“ = st.text_input("ì—°ì†Œë“", value='', placeholder="ì—°ì†Œë“ ì…ë ¥ (ë§Œì›)", help="ì—°ê°„ ê·¼ë¡œì†Œë“ì—ì„œ ë¹„ê³¼ì„¸ì†Œë“(ì‹ëŒ€, êµí†µë¹„, ì–‘ìœ¡ë¹„ ë“±)ì„ ì œì™¸í•œ ê¸ˆì•¡ì…ë‹ˆë‹¤")
        if ì—°ì†Œë“:
            st.write(ì—°ì†Œë“, "ë§Œì›")
        ì‹ ìš© = st.text_input("ì‹ ìš©ì¹´ë“œ", value='',  placeholder="ì‚¬ìš©ì•¡ ì…ë ¥ (ë§Œì›)",help="ì‚¬ìš©ì•¡ ì…ë ¥")
        if ì‹ ìš©:
            st.write(ì‹ ìš©, "ë§Œì›")
        
        í˜„ê¸ˆ = st.text_input("í˜„ê¸ˆì˜ìˆ˜ì¦", value='', placeholder="ì‚¬ìš©ì•¡ ì…ë ¥ (ë§Œì›)", help="ì‚¬ìš©ì•¡ ì…ë ¥")
        if í˜„ê¸ˆ:
            st.write(í˜„ê¸ˆ, "ë§Œì›")
        else:
            í˜„ê¸ˆ = 0
        
        ì²´í¬ = st.text_input("ì²´í¬ì¹´ë“œ", value='', placeholder="ì‚¬ìš©ì•¡ ì…ë ¥ (ë§Œì›)", help="ì‚¬ìš©ì•¡ ì…ë ¥")
        if ì²´í¬:
            st.write(ì²´í¬, "ë§Œì›")
        else:
            ì²´í¬ = 0
        
        try:
            ì—°ì†Œë“ = int(ì—°ì†Œë“)
            ì‹ ìš© = int(ì‹ ìš©)
            í˜„ê¸ˆ = int(í˜„ê¸ˆ)
            ì²´í¬ = int(ì²´í¬)
        except ValueError:
            ì‹ ìš© = 0
            í˜„ê¸ˆ = 0
            ì²´í¬ = 0

        if ì—°ì†Œë“:
            button_enable = False
        else:
            button_enable = True

        button_result = st.button("ê³„ì‚°", disabled=button_enable)

    with col2:
        # 1ë‹¨ê³„
        # 2ë‹¨ê³„
        # 3ë‹¨ê³„
        if button_result:
            global ì†Œë“ê³µì œ_í•œë„ì•¡
            ì†Œë“ê³µì œ_í•œë„ì•¡ = ê¸‰ì—¬ë³„_ì´í•œë„ì•¡(ì—°ì†Œë“)
            ê³¼ì„¸ = ê³¼ì„¸í‘œì¤€()
            st.markdown('<p class="title">ë¶„ì„ê²°ê³¼</p>', unsafe_allow_html=True)
            ì†Œë“_ê³µì œ = round(ê³¼ì„¸.ì†Œë“ê³µì œ(ì—°ì†Œë“, ì‹ ìš©, í˜„ê¸ˆ, ì²´í¬))
            ë¶„ì„ê²°ê³¼ = ì†Œë“ê³µì œ_ê²°ê³¼(ì†Œë“_ê³µì œ)
            
            st.markdown(ë¶„ì„ê²°ê³¼, unsafe_allow_html=True)
            st.markdown('<p class="title">ì¶”ì²œ</p>', unsafe_allow_html=True)
            
            def compare(ì†Œë“_ê³µì œ, ì‹ ìš©, ì²´í¬_í˜„ê¸ˆ):
                '''
                ì‹ ìš©ê³µì œê°€ ì¶©ì¡±ë  ë•Œ, ì•ˆë  ë–„
                ì•ˆë˜ë©´, ì‹ ìš© ì¶©ì¡± ì‹œí‚¤ëŠ” ê²Œ ì¢‹ì„ì§€, ì•ˆì¢‹ì„ì§€
                '''
                if ì†Œë“_ê³µì œ == ì†Œë“ê³µì œ_í•œë„ì•¡:
                    st.markdown('<p class="highlight-result">ì†Œë“ê³µì œë¥¼ ëª¨ë‘ ì±„ìš°ì…¨ê¸° ë•Œë¬¸ì—, í˜œíƒì´ ì¢‹ì€ ì¹´ë“œë¥¼ ì“°ì‹œëŠ” ê±¸ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.</p>', unsafe_allow_html=True)
                else:
                    # ì‹ ìš©ì¹´ë“œ ì‚¬ìš©ëŸ‰ì´ ë§ì•„ì„œ ì²´í¬í˜„ê¸ˆ ê³µì œ ë¹¼ê³  ë¶€ì¡± ê¸ˆì•¡ì„ ì‹ ìš©ê¸ˆì•¡ìœ¼ë¡œë§Œ ì±„ì› ì„ ë•Œ
                    ë¶€ì¡±_ì‹ ìš© = ì—°ì†Œë“*0.25 - ì‹ ìš©
                    if ë¶€ì¡±_ì‹ ìš© <= 0:
                        # ë¶€ì¡±_ì‹ ìš©ë§Œ = (ì†Œë“ê³µì œ_í•œë„ì•¡ - ì‹ ìš©_ê³µì œ - ì²´í¬_í˜„ê¸ˆ_ê³µì œ)/0.15
                        ë¶€ì¡±_ì²´í¬_í˜„ê¸ˆ = (ì†Œë“ê³µì œ_í•œë„ì•¡ + ë¶€ì¡±_ì‹ ìš©*0.15 - ì²´í¬_í˜„ê¸ˆ*0.3)/0.3
                        ì¶”ì²œ_ë°©ë²• = 'ë¶€ì¡±_ì²´í¬_í˜„ê¸ˆ'
                    else:
                        # ì²´í¬í˜„ê¸ˆ ê³µì œ ë¹¼ê³  ë¶€ì¡± ê¸ˆì•¡ì„ ì‹ ìš© + ì²´í¬í˜„ê¸ˆìœ¼ë¡œ ì±„ì› ì„ ë•Œ
                        ë¶€ì¡±_ì²´í¬_í˜„ê¸ˆ = (ì†Œë“ê³µì œ_í•œë„ì•¡ - ì²´í¬_í˜„ê¸ˆ*0.3)/0.3
                        
                        # ì²´í¬í˜„ê¸ˆ ê³µì œ ë¹¼ê³  ë¶€ì¡± ê¸ˆì•¡ì„ ì²´í¬í˜„ê¸ˆìœ¼ë¡œë§Œ ì±„ì› ì„ ë•Œ
                        ë¶€ì¡±_ì‹ ìš©_ì²´í¬_í˜„ê¸ˆ = ì†Œë“ê³µì œ_í•œë„ì•¡/0.3 + ë¶€ì¡±_ì‹ ìš© - ì²´í¬_í˜„ê¸ˆ
                        
                        def str_values(ë¶€ì¡±_ì²´í¬_í˜„ê¸ˆ, ë¶€ì¡±_ì‹ ìš©_ì²´í¬_í˜„ê¸ˆ):
                            return locals()
                        ì¶”ì²œ_ë°©ë²• = min(str_values(ë¶€ì¡±_ì²´í¬_í˜„ê¸ˆ, ë¶€ì¡±_ì‹ ìš©_ì²´í¬_í˜„ê¸ˆ))
                    
                    if ì¶”ì²œ_ë°©ë²• == 'ë¶€ì¡±_ì²´í¬_í˜„ê¸ˆ':
                        st.markdown('<p class="highlight-recommand">ì²´í¬ì¹´ë“œ ë° í˜„ê¸ˆì„ ìš°ì„ ì ìœ¼ë¡œ ì‚¬ìš©í•˜ì„¸ìš”.</p>', unsafe_allow_html=True)
                        
                        col1, col2 = st.columns(2)
                        col1.metric("ì²´í¬ì¹´ë“œ & í˜„ê¸ˆì˜ìˆ˜ì¦", f"{int(ë¶€ì¡±_ì²´í¬_í˜„ê¸ˆ)}ë§Œì›")
                        
                    elif ì¶”ì²œ_ë°©ë²• == 'ë¶€ì¡±_ì‹ ìš©_ì²´í¬_í˜„ê¸ˆ':
                        st.markdown('<p class="highlight-recommand">ì‹ ìš©ì¹´ë“œë¥¼ ìš°ì„ ì ìœ¼ë¡œ ì‚¬ìš©í•˜ì„¸ìš”.</p>', unsafe_allow_html=True)
                        
                        col1, col2= st.columns(2)
                        col1.metric("ì‹ ìš©ì¹´ë“œ", f"{int(ë¶€ì¡±_ì‹ ìš©)}ë§Œì›")
                        if ë¶€ì¡±_ì‹ ìš©_ì²´í¬_í˜„ê¸ˆ - ë¶€ì¡±_ì‹ ìš© != 0:
                            col2.metric("ì²´í¬ì¹´ë“œ & í˜„ê¸ˆì˜ìˆ˜ì¦", f"{int(ë¶€ì¡±_ì‹ ìš©_ì²´í¬_í˜„ê¸ˆ - ë¶€ì¡±_ì‹ ìš©)}ë§Œì›")
                    
            ì²´í¬_í˜„ê¸ˆ = ì²´í¬ + í˜„ê¸ˆ
            compare(ì†Œë“_ê³µì œ, ì‹ ìš©, ì²´í¬_í˜„ê¸ˆ)
            
            
style = """
    <style>
    .title {
    font-size: 30px !important;
    font-weight: bold !important;
    }
    .highlight-text {
        background-color: rgba(0, 128, 0, 0.2) !important;
        padding: 5px;
        border-radius: 5px;
    }
    .highlight-result {
        background-color: rgba(0, 128, 0, 0.2) !important;
        padding: 5px;
        border-radius: 5px;
    }
    .highlight-recommand {
        background-color: rgba(255, 0, 0, 0.2) !important;
        padding: 5px;
        border-radius: 5px;
    }
    .footer {
        position: fixed;
        bottom: 0;
        right: 0;
        padding: 10px;
    }
    .stTextInput input {
    font-size: 30px !important;
    }
    .markdown-text-container {
        font-size: 30px !important;
    }
    </style>
    """            
            
if __name__ == '__main__':
    main()

    # Copyright ë° ì£¼ì˜ ì‚¬í•­ í…ìŠ¤íŠ¸
    copyright_text = """

    ê°„ë‹¨í•œ ì†Œë“ê³µì œ í™•ì¸ì„ ìœ„í•œ ë„êµ¬ì¼ ë¿ì´ë©°, ì‹¤ì œ ê²°ê³¼ì™€ëŠ” ì°¨ì´ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
    ì°¸ê³ ë¡œë§Œ í™œìš©í•˜ì‹œê³  ê°œë°œìëŠ” ì–´ë– í•œ ë²•ì  ì±…ì„ë„ ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤. Â© Copyright KBAE
    
    """

    st.markdown(style, unsafe_allow_html=True)
    st.markdown(f'<div class="footer">{copyright_text}', unsafe_allow_html=True)
